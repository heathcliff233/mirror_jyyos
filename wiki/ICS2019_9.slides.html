<html>
  <Head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    
<link rel="stylesheet" href="../static/css/bootstrap.min.css"/>
<link rel="stylesheet" href="../static/css/bootstrap-theme.min.css"/>


    <link rel="stylesheet" href="../static/css/fonts/crmison.css"/>
    <link rel="stylesheet" href="../static/css/fonts/fira_code.css"/>
    <link rel="stylesheet" href="../static/css/fonts/ptsans.css"/>
    <link rel="stylesheet" href="../static/css/katex.min.css"/>
    <link rel="stylesheet" href="../static/css/wiki.css"/>
    <link rel="stylesheet" href="../static/css/codehilite.css"/>

    <script src="../static/js/jquery.min.js"></script>
    <script src="../static/js/bootstrap.bundle.min.js"></script>
    <script src="../static/js/katex.min.js"></script>
    
<link rel="stylesheet" href="../static/css/wiki.css"/>
<link rel="stylesheet" href="../static/css/slides.css"/>


    <title>ç³»ç»Ÿç¼–ç¨‹ä¸åŸºç¡€è®¾æ–½</title>
  </Head>
  <body>
   
   
<textarea id="source">
public: True
class: center, middle

# ç³»ç»Ÿç¼–ç¨‹ä¸åŸºç¡€è®¾æ–½

è’‹ç‚å²© <jyy@nju.edu.cn>

å—äº¬å¤§å­¦è®¡ç®—æœºè½¯ä»¶ç ”ç©¶æ‰€

---


# æ¦‚è¿°

> æ„Ÿå—åˆ°PAçš„æ¶æ„äº†å—ï¼Ÿ
>
> * ä¸å°±æ˜¯å†™å‡ è¡Œä»£ç ä¹ˆï¼Œæ€ä¹ˆâ€¦â€¦æ€ä¹ˆå†™ä¸å¯¹å•Šâ€¦â€¦
> * è¿™å°±æ˜¯ä¸ºä»€ä¹ˆPAè¦æé‚£ä¹ˆéº»çƒ¦ï¼šåˆæ˜¯Makefileï¼Œåˆæ˜¯å„ç§é¡¹ç›®/å·¥å…·
> * æ²¡æœ‰.red[åŸºç¡€è®¾æ–½]ï¼ŒPAçš„å®Œæˆç‡ä¼šå¤§å¹…é™ä½

----

* å¼€å‘/è°ƒè¯•çš„åŸºç¡€è®¾æ–½
* Differential testing
* ç³»ç»Ÿç¼–ç¨‹ï¼šåŸºç¡€è®¾æ–½

---
class: center, middle

# å¼€å‘/è°ƒè¯•çš„åŸºç¡€è®¾æ–½

---

# ä½ ä»¬æ˜¯æ€ä¹ˆå†™ç¨‹åºçš„ï¼Ÿ

è™½ç„¶å¾ˆå¤šåŒå­¦å·²ç»é…ç½®å¥½äº†è‰¯å¥½çš„ç¼–ç¨‹ç¯å¢ƒï¼Œä½†ä¾ç„¶æœ‰å¾ˆå¤šåŒå­¦ â€œ.red[é¢å‘æµªè´¹æ—¶é—´ç¼–ç¨‹]â€

* yzh æ¨è vim/tmux çš„åŸå› æ˜¯å¤§å®¶ç”¨ IDE å®¹æ˜“è¿·å¤±è‡ªæˆ‘ (å…³æ³¨è¡¨è±¡ï¼Œè€Œä¸çŸ¥é“å†…åœ¨æ˜¯å¦‚ä½•å·¥ä½œçš„)
* åœ¨ä½ ææ¸…æ¥šçš„å‰æä¸‹ï¼Œä¹Ÿå¯ä»¥è§£æ”¾è‡ªæˆ‘

----

```text
$ gcc a.c
a.c: In function â€˜mainâ€™:
a.c:5:1: error: â€˜aâ€™ undeclared (first use in this function)
$ vi a.c
$ gcc a.c
$ ./a.out
1 2           // ä½ è¾“å…¥çš„
zsh: segmentation fault (core dumped)  ./a.out
...
```

---

# åŸºç¡€è®¾æ–½çš„æœ¬è´¨

é€šè¿‡é€‚å½“çš„é…ç½®ã€è„šæœ¬å‡å°‘æ€ç»´ä¸­æ–­çš„æ—¶é—´ï¼Œæé«˜è¿è´¯æ€§ï¼Œä¿æŒçŸ­æ—¶è®°å¿†æ´»è·ƒ

* `make` (fresh build) â†’ 4sï¼Œå·²è¢«æ‰“æ–­
* `make` (parallel) â†’ 0.5s

----

åŸºæœ¬åŸåˆ™ï¼š.red[å¦‚æœä½ è®¤ä¸ºæœ‰æé«˜æ•ˆç‡çš„å¯èƒ½æ€§ï¼Œä¸€å®šæœ‰äººå·²ç»åšäº†]

* æ¯æ¬¡éƒ½ `make -j8`?
    * æˆ–è€… `alias make='make -j8'`
    * åœ¨ Makefile é‡ŒåŠ ä¸€è¡Œ `MAKEFLAGS += -j 8` (better)

---

# å¿ƒæ€åˆ†æ

æœ¬è´¨ä¸Šï¼Œè¿™äº›éƒ½ä¸æ˜¯éš¾äº‹ï¼ŒSTFW éšæ‰‹å³æ¥ï¼Œä½†å¤§å®¶é€šå¸¸åšä¸å¥½

* å°šæœª GET STFW çš„æŠ€èƒ½ 
    * å»ºè®®ï¼šåœ¨ hosts ä¸­å±è”½ç™¾åº¦; ä¿®æ”¹é»˜è®¤æœç´¢å¼•æ“; ...
* æƒ°æ€§
    * é”®å…¥ `make -j8`: å¢åŠ  1s æ—¶é—´
    * STFW: è‡³å°‘éœ€è¦å‡ åˆ†é’Ÿï¼Œè€Œä¸”æœ‰ä¸å°‘å¤±è´¥å°è¯• (çŸ­æœŸæ”¶ç›Šæ˜¯è´Ÿçš„ï¼Œå°¤å…¶æ˜¯ä¸Šè¯¾ workloads å·²ç»å¾ˆé‡çš„å‰æä¸‹)
    * å…‹æœæƒ°æ€§å¯ä»¥ä½¿ä½ å¿«é€Ÿæˆé•¿

---

# å¿ƒæ€åˆ†æ (cont'd)

åœ¨å¾ˆå¤šå°äº‹ä¸Šï¼Œå¯èƒ½å¹¶ä¸å¸¦æ¥æ˜¾è‘—çš„æ”¶ç›Š
* æ¯æ¬¡é”®å…¥ `make -j8` å¯èƒ½å¹¶ä¸æ˜¾è‘—ç¼©çŸ­ PA å®Œæˆçš„æ—¶é—´
* ä½†ä¹…è€Œä¹…ä¹‹æˆä¸ºä¹ æƒ¯ï¼Œä½ å°±æ€»æ˜¯.red[æƒ³ç€æ”¹è¿›åŸºç¡€è®¾æ–½]

---
class: center, middle

# Differential Testing

---

# å¤ä¹ ï¼šæµ‹è¯•/è°ƒè¯•çš„ç†è®º

Fault â†’ Error â†’ Failure

----

å¯¹äº PA æ¥è¯´ï¼Œfailure æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼š

* Segmentation Fault äº†ï¼Œfail
* HIT BAD TRAP äº†ï¼Œfail
* é©¬é‡Œå¥¥/ä»™å‰‘ä¸èƒ½è·‘å˜›ï¼Œfail

æˆ‘å·²ç»è°ƒäº†å¾ˆä¹…äº†ï¼Œä½†å°±æ˜¯æ‰¾ä¸åˆ°é‚£ä¸ªå¯¼è‡´ error çš„æŒ‡ä»¤å•ŠğŸ˜±ğŸ˜±ğŸ˜±

----

è°ƒè¯•ç†è®ºæ²¡æœ‰å‘Šè¯‰å¤§å®¶ï¼šæ€æ ·.red[æ‰¾åˆ° error å‘ç”Ÿçš„ä½ç½®]ï¼Ÿ

---

# æ€ä¹ˆåŠ (ä¸å€ŸåŠ©ä»–äººç‰ˆæœ¬)ï¼Ÿ

<br/>

<br/>

<br/>

# .center[.red[æŒ«]]

# .center[.red[è´¥]]

---

# æŠ±å¤§è…¿ï¼šæƒ³æ³•

å¦‚æœå­¦é•¿/åŒå­¦å·²ç»æœ‰ä¸€ä»½æ­£ç¡®çš„ä»£ç ï¼Œèƒ½ä¸èƒ½å€ŸåŠ©è¿™ä¸ªä»£ç å¿«é€Ÿè¯Šæ–­å‡ºè‡ªå·±ä»£ç çš„é—®é¢˜ï¼Ÿ

* åŒå­¦ä»¬æ˜¯éå¸¸æ™ºæ…§çš„ï¼Œåœ¨ ICS-PA åˆ›ç«‹çš„åˆæœŸå‘æ˜äº†æ›¿æ¢è°ƒè¯•æ³•
    * PA æ˜¯åˆ†æ¨¡å—å®ç°çš„ (è‹¥å¹²ä¸ª `.c`)
    * ä»å¤§è…¿åŒå­¦çš„ä»£ç å¼€å§‹ï¼Œé€ä¸ªæ›¿æ¢è¿›è‡ªå·±å®ç°çš„ `.c` 
    * ç¬¬ä¸€ä¸ªæ›¿æ¢è¿›çš„æ–‡ä»¶é‡Œæœ‰ bug
    
----

.blue[Cool!]

* å¯èƒ½çš„æ”¹è¿›ï¼šä»¥å‡½æ•°çº§è¿›è¡Œæ›¿æ¢ç­‰ç­‰

---

# æŠ±å¤§è…¿ï¼šå»ºç«‹åŸºç¡€è®¾æ–½

å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ï¼š

* åªéœ€è¦å¤§è…¿çš„ compiled binary
* æŒ‡ä»¤çº§å®šä½å‡ºé”™çš„ä½ç½®

```python
for i in range(int(sys.argv[1])):   # Life is short
  print("\n".join(["si"] +          # You need python
    [f"p %{r}" for r in ["eax", "ebx", ...]]))
```

----

ç„¶åå°±å¯ä»¥å®ç°â€œå¯¹æ¯”â€ï¼š

```bash
diff() { # ä½¿ç”¨ diff è¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾
  python3 cmdgen.py $1 | ./build/x86-nemu -b -l 1.log img; \
  python3 cmdgen.py $1 | ./x86-nemu-datui -b -l 2.log img; \
  (diff -q 1.log 2.log > /dev/null && echo "Pass") || \
    echo "Fail"
}
```

---

# è¿™å°±æ˜¯Differential Testing

â€œ.green[åŒä¸€å¥—æ¥å£ (API)] çš„.green[ä¸¤ä¸ªå®ç°]åº”å½“è¡Œä¸ºå®Œå…¨ä¸€è‡´â€

* NEMU ä¸­ï¼Œè¿™ä¸ªæ¥å£æ˜¯æŒ‡ä»¤ï¼›æˆ‘ä»¬æ‰¾åˆ°ç¬¬ä¸€ä¸ªè¡Œä¸ºä¸åŒçš„æŒ‡ä»¤
* ä½ ä»¬æƒ³æƒ³æœ‰ä»€ä¹ˆ.red[ç°å®ä¸­è½¯ä»¶ç³»ç»Ÿ]çš„ä¾‹å­ï¼Ÿ

--
count: false
----

Differential testing æ˜¯ real research (excitedğŸ…)

* æµè§ˆå™¨ [Mesbah and Prasad, ICSE'11](https://dl.acm.org/citation.cfm?id=1985870)
* GCC (vs clang), [Yang et al., PLDI'11](https://embed.cs.utah.edu/csmith/)
* æ–‡ä»¶ç³»ç»Ÿ, [Min et al., SOSP'15](https://dl.acm.org/citation.cfm?id=2815422)
* Gcov (vs llvm-cov), æˆ‘ä»¬çš„å·¥ä½œ!
* æ½œåœ¨/å·²æœ‰çš„ä¸€äº›ç ”ç©¶ï¼šdebugger, OS API (Windows Subsystem for Linux), æ•°æ®åº“...

---

# Self-Validation of Coverage Profilers

â€œè‡ªå·±å’Œè‡ªå·±åš differential testingâ€ (ASE'19)

* æ”¹å˜æœªæ‰§è¡Œçš„ä»£ç ï¼Œå…¶ä»–éƒ¨åˆ†çš„ä»£ç è¦†ç›–ç‡ç»Ÿè®¡åº”è¯¥ä¸å˜
* å˜äº†è¯´æ˜ä»£ç è¦†ç›–ç‡ç»Ÿè®¡æœ‰é—®é¢˜

.center[<img src="../static/wiki/ics/2019/img/cod-coverage.png" width="600px"/>]

---

class: center, middle

# å®ç° Differential Testing

---

# åŸç†

åˆšæ‰æˆ‘ä»¬å·²ç»ç»™å¤§è…¿çš„ä»£ç å®ç°äº†ä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„ diff-testing

æˆ‘ä»¬è¿˜æœ‰.red[çœŸæ­£çš„å¤§è…¿]ï¼šQEMU & gdb

* ICS PA = ç¼©æ°´ç‰ˆ QEMU
* monitor = ç¼©æ°´ç‰ˆ gdb

å®é™…ä¸Š PA å°±æ˜¯ç®€åŒ– (æ•™å­¦) ç‰ˆçš„ QEMU/gdb

--

count: false

----

diff-testing åˆæ°å¥½æ˜¯ä¸€ä¸ªå’Œ.red[å¤–éƒ¨ä¸–ç•Œæ‰“äº¤é“]çš„æ•…äº‹

* ä»¥å‰æˆ‘ä»¬ä¸€ç›´éƒ½åªæ˜¯è‡ªå·±å†™è‡ªå·±çš„ç¨‹åºï¼Œè°ƒç”¨åº“å‡½æ•°
* diff-testing ä¹Ÿè®¸æ˜¯ä½ ä»¬ç¬¬ä¸€æ¬¡è§åˆ°å’Œå…¶ä»–ç¨‹åº (QEMU, gdb) .red[åä½œ/äº¤äº’]çš„ç¨‹åº

---

# åŸç† (cont'd)

```bash
# diff-stream: åœ¨ç¬¬ä¸€ä¸ªä¸åŒçš„è¾“å‡ºä¸Šåœæ­¢
# gen-cmds: ä¸æ–­ç”Ÿæˆ si; p $eax; p $ebx; ...
diff-stream <(gen-cmds | nemu-1) <(gen-cmds | nemu-2) 
```

----

æ”¹è¿›ç‰ˆçš„ â€œæŠ±å¤§è…¿â€ ä»£ç ï¼Œä¸éœ€äºŒåˆ†æŸ¥æ‰¾

* åŒæ—¶å¯åŠ¨ä¸¤ä¸ª NEMU (QEMU)
* åœ¨ç¬¬ä¸€ä¸ªè¾“å‡ºä¸åŒæ—¶åœæ­¢

---

# åŸç† (cont'd)

é—®é¢˜åˆ†æï¼šæˆ‘ä»¬éœ€è¦ä½¿ QEMU åƒ NEMU ä¸€æ ·æ‰§è¡ŒæŒ‡ä»¤ï¼

* QEMU å®ç°äº† gdb çš„åè®®
* åè®®æ ¼å¼åŒ monitor

----

qemu-diff å®ç°ï¼š

1. å¯åŠ¨ QEMU å¹¶é…ç½®å®ƒè¿›å…¥ä¸ PA ç±»ä¼¼çš„æ¨¡å¼
2. ç”¨ gdb è¿æ¥ QEMU
3. ç”¨ `gdb_si()` åœ¨ QEMU ä¸­æ‰§è¡Œä¸€æ¡æŒ‡ä»¤
4. æ¯”è¾ƒæŒ‡ä»¤æ‰§è¡Œåå¯„å­˜å™¨æ˜¯å¦æœ‰åŒºåˆ«

---

# ä»£ç å¯¼è¯»

é¦–å…ˆ PA ä»£ç  (`src/`) é‡Œ.red[æ²¡æœ‰] diff-test çš„å®é™…ä»£ç ï¼Œåªæœ‰ä¸€å †å‡½æ•°æŒ‡é’ˆï¼š

```c
static void (*ref_difftest_memcpy_from_dut)(paddr_t dest, void *src, size_t n);
static void (*ref_difftest_getregs)(void *c);
static void (*ref_difftest_setregs)(const void *c);
static void (*ref_difftest_exec)(uint64_t n);
```

è¿™äº›å‡½æ•°å°è£…äº†å‚è€ƒå®ç°çš„åŠŸèƒ½
* æ—¢å¯ä»¥å’Œ QEMU diff-testï¼Œä¹Ÿå¯ä»¥å’Œ NEMU diff-test
* `exec_wrapper()` ä¸­æ‰§è¡Œ.red[ä¸€æ¡]æŒ‡ä»¤ä¹‹åç›´æ¥å¯¹æ¯”ç»“æœå°±è¡Œ

```c
#if defined(DIFF_TEST)
  difftest_step(ori_pc, cpu.pc);
#endif
```

---

# ä»£ç å¯¼è¯» (cont'd)

ç»è¿‡ RTFM/RTFSCï¼š

* `nemu/tools/qemu-diff` æ˜¯ differential testing å®é™…å®ç°çš„ç›®å½•

----

ç„¶åRTFSCï¼Œçœ‹åˆ°äº†è‹¥å¹²æœ‰ç”¨çš„å‡½æ•°ï¼š

* `gdb_connect_qemu`ï¼Œçœ‹èµ·æ¥å°±æ˜¯ç”¨æ¥è¿æ¥åˆ° QEMU çš„ï¼Œåˆ›å»ºä¸€ä¸ªåˆ° 127.0.0.1ã€ç«¯å£æ˜¯ 1234 çš„ gdb è¿æ¥
* `gdb_si`ï¼Œå’Œ monitor ä¸€æ ·ï¼Œå•æ­¥æ‰§è¡ŒæŒ‡ä»¤
* `gdb_setregs`, `gdb_getregs`ï¼Œå¥½åƒå¤æ‚ä¸€ç‚¹ï¼Œä¸è¿‡å°±æ˜¯ç”¨ `gdb_send()` å’Œ `gdb_recv()` å‘é€/æ¥æ”¶æ¶ˆæ¯

---

# ä»£ç å¯¼è¯» (cont'd)

ä¸»è¦çš„å®ç°è¿˜æ˜¯åœ¨diff-test.cä¸­

* é˜…è¯»è¿™äº›ä»£ç çš„æ—¶å€™ä¼šé‡åˆ°ä¸€å®šçš„å›°éš¾ï¼Œ.red[æ€ä¹ˆåŠå‘¢]ï¼Ÿ
* é‡åˆ°ä¸æ˜ç™½çš„å‡½æ•°ï¼ŒæŸ¥æ‰‹å†Œ/è¯»ä»£ç 

----

diff-test æµç¨‹

* åŠ¨æ€é“¾æ¥åº“è¢«åŠ è½½
* diff-test åˆå§‹åŒ–ï¼ŒåŠ è½½ MBRï¼Œå¯åŠ¨ QEMU å’Œåˆå§‹åŒ–è¿›å…¥ä¿æŠ¤æ¨¡å¼
* diff-test è°ƒç”¨ `ref_difftest_memcpy_from_dut(ENTRY_START, guest_to_host(ENTRY_START), img_size);` åŒæ­¥é•œåƒ
* ä¹‹åæ¯æ‰§è¡Œä¸€æ¡æŒ‡ä»¤éƒ½ä¼šæŠŠå¯„å­˜å™¨ç°åœºä» DUT å¤åˆ¶åˆ° REF

---

# diff-test çš„å±€é™

Differential testing ä¹Ÿä¸æ˜¯ç»å¯¹ä¸‡èƒ½çš„
--
count:false

* å¦‚æœä½ æ˜¯ç¬¬ä¸€ä¸ªå®ç°æ¨¡æ‹Ÿå™¨çš„â€¦â€¦
    * å¿ƒç–¼ç¬¬ä¸€å±Šåšå®éªŒçš„åŒå­¦
* å¯¹æ¯” memory çš„ä»£ä»·å¤ªå¤§ï¼Œé€‰æ‹©å¿½ç•¥
    * å¦‚æœé”™è¯¯çš„å†…å­˜å¾ˆä¹…ä¹‹åæ‰ä½¿ç”¨ï¼Œä¼šç»™ debugging å¸¦æ¥ä¸€äº›å›°éš¾
    * è§£å†³æ–¹æ³•ï¼šå¢åŠ  taint analysis
* æ— æ³•æ£€æµ‹é…ç½®é”™

---

class: center, middle

# ç³»ç»Ÿç¼–ç¨‹ï¼šåŸºç¡€è®¾æ–½

.red[æœºå™¨æ°¸è¿œæ˜¯å¯¹çš„]

.red[æœªæµ‹ä»£ç æ°¸è¿œæ˜¯é”™çš„]

ä½ ä»¬æ„Ÿå—åˆ°äº†å—ï¼Ÿ

---

# ç³»ç»Ÿç¼–ç¨‹çš„å›°éš¾

åœ¨ç¨‹åºè§„æ¨¡åˆ°è¾¾ä¸€å®šç¨‹åº¦çš„æ—¶å€™ï¼Œä»£ç æ—¢éš¾ç®¡ç†ï¼Œä¹Ÿéš¾å†™å¯¹

* å³ä¾¿åœ¨é¡¹ç›®æ–‡ä»¶ä¹‹é—´æµè§ˆå°±å·²ç»éå¸¸è€—æ—¶
    * é¢å¯¹ä¸ç†Ÿæ‚‰çš„æ¨¡å—/API
    * éœ€è¦å¥½çš„ IDEã€ä»£ç æŠ˜å ã€ç¬¬äºŒå—å±å¹•â€¦â€¦
* ç¼–ç¨‹ç»éªŒå¯ä»¥.green[å‡å°‘] bugï¼Œä½†å¾ˆéš¾å®Œå…¨.red[æ¶ˆç­]å®ƒä»¬
    * å„ç±»è‚‰çœ¼éš¾ä»¥å‘ç°çš„ä½çº§é”™è¯¯ (`i` vs. `j`, `0x` vs `0b`, `int` with `unsigned`, ...)
    * è¯»é”™äº†æ‰‹å†Œ (å¿˜è®°æ›´æ–°æŸä¸ª flags, è®°é”™ 0/ç¬¦å·æ‰©å±•, ...)
    * é€»è¾‘ä¸Šçš„é”™è¯¯ (ä½¿ç”¨ä¸€å—å·²ç»é‡Šæ”¾çš„å†…å­˜, è™šæ‹Ÿ/ç‰©ç†å†…å­˜åœ°å€è®¿é—®é”™, ...)

----

åšè¿‡ PA çš„äººå°±çŸ¥é“ï¼Œâ€œæœºå™¨æ°¸è¿œæ˜¯å¯¹çš„â€ä¸æ˜¯å¼€ç©ç¬‘çš„

* ä½ æŠ˜è…¾ä¸€å¤©ï¼Œä¸¤å¤©ï¼Œå¯èƒ½å°±æ˜¯å¤šæ‰“äº†ä¸€ä¸ªç©ºæ ¼

---

# åŸºç¡€è®¾æ–½ï¼šå¸®åŠ©ä½ æ›´å¿«æ›´å¥½åœ°ç”Ÿäº§ä»£ç 

ç»ˆææ¢¦æƒ³ï¼šè®©è®¡ç®—æœºè‡ªåŠ¨å¸®æˆ‘ä»¬å†™ç¨‹åº

* å‘Šè¯‰è®¡ç®—æœºéœ€æ±‚ â†’ è®¡ç®—æœºè¾“å‡ºæ­£ç¡®çš„ä»£ç 
* è®¡ç®—æœºç§‘å­¦çš„ holy grail ä¹‹ä¸€

----

ç°åœ¨æˆ‘ä»¬è¿˜åœ¨è½¯ä»¶è‡ªåŠ¨åŒ–çš„åˆçº§é˜¶æ®µ

* è®¡ç®—æœºåªèƒ½æä¾›æœ‰é™çš„è‡ªåŠ¨åŒ– (åŸºç¡€è®¾æ–½)
    * é›†æˆå¼€å‘ç¯å¢ƒ (IDE)
    * é™æ€åˆ†æ
    * åŠ¨æ€åˆ†æ
* ä½†è¿™äº›åŸºç¡€è®¾æ–½å·²ç»ä»æœ¬è´¨ä¸Šæ”¹å˜äº†æˆ‘ä»¬çš„å¼€å‘æ•ˆç‡
    * ä½ ç»å¯¹ä¸ä¼šæ„¿æ„ç”¨è®°äº‹æœ¬å†™ç¨‹åºçš„

---

# åŸºç¡€è®¾æ–½

å½“æˆ‘ä»¬å¤§è§„æ¨¡è½¯ä»¶å·¥ç¨‹å®è·µé‡åˆ°å›°éš¾çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦å».red[æ‰¾è½®å­]

* (æ—¥å¸¸ç®¡ç†) æ•ˆç‡ä½ â†’ .red[ç†Ÿç»ƒä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·/Python]
* (é¡¹ç›®ç®¡ç†) ä½ å·²ç»ä¼š `gcc a.c`äº†ï¼Œä½†æ²¡æ³•ç®¡ç†å‡ åä¸ªæ–‡ä»¶ â†’ .red[make]ï¼Œå®ç°.green[ä¸€é”®ç¼–è¯‘]ã€.green[ä¸€é”®è¿è¡Œ]
* (ä»£ç ç¼–è¾‘) åœ¨ä»£ç é‡Œè·³æ¥è·³å»å¾ˆéº»çƒ¦  â†’ .red[IDE/é…ç½®Vim/è£…æ’ä»¶]
* (é”™è¯¯æ£€æŸ¥) å¾ˆå®¹æ˜“çŠ¯ä½çº§é”™è¯¯ â†’ .red[-Wall -Werror]
* (ä»£ç è°ƒè¯•) Segmentation Faultäº†  â†’ .red[gdb]

----

ä¸å¤¸å¼ åœ°è¯´ï¼Œä½¿ç”¨/ä¸ä½¿ç”¨æ­£ç¡®çš„å·¥å…·ï¼Œæ•ˆç‡å¯ä»¥å·®.red[å‡ ååˆ°å‡ ç™¾å€]

* èµ°ä¸Šäººç”Ÿå·…å³° (è½»æ¾æŒ‘æˆ˜æ›´æœ‰éš¾åº¦çš„ä»»åŠ¡) vs. æ¯•ä¸šå›°éš¾ (æ— æ³•å®Œæˆè¯¾ç¨‹ä½œä¸š)

---

# åŸºç¡€è®¾æ–½ï¼šç¨‹åºåˆ†æ (Program Analysis)

é™æ€(ç¨‹åº)åˆ†æï¼šåˆ†æ.red[æºä»£ç ]è¯æ˜/æ¨æ–­/æ¨¡æ‹Ÿæ‰§è¡Œç¨‹åº

* ç¼–è¯‘å™¨ (-Wall -Werror)/ä¼˜åŒ–
* linter ä»£ç é£æ ¼æ£€æŸ¥
* FindBugï¼šå„ç§åŸºäº bug pattern çš„æ£€æŸ¥ï¼Œæ¯”å¦‚ç¼“å†²åŒºæº¢å‡º

----

åŠ¨æ€(ç¨‹åº)åˆ†æï¼šåˆ†æ/æ§åˆ¶.red[ç¨‹åºæ‰§è¡Œ] (trace, log, â€¦)

* gdb (å¸®åŠ©ä½ åˆ†æç¨‹åºæ‰§è¡Œ)
* diff-test (å¯¹æ¯”ä¸¤ä¸ªç¨‹åºçš„æ‰§è¡Œ)
* perf æ€§èƒ½å·¥å…·

---

# åŸºç¡€è®¾æ–½ï¼šå°ç»“

å½“è½®å­éƒ½ä¸å¤Ÿç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å».red[é€ è½®å­]

* è°ƒè¯•å›°éš¾ï¼Œæœ‰å‚è€ƒå®ç° â†’ .red[diff-test]
* éš¾ä»¥è´¯é€šå¤šé—¨å®éªŒè¯¾ â†’ .red[AbstractMachine]

--

count: false

----

è½®å­è¿˜ä¸å¤Ÿç”¨å‘¢ï¼Ÿ

* diff-test æ¯ç§’åªèƒ½æ£€æŸ¥ ~5000 æ¡æŒ‡ä»¤
* ä¸­æ–­å’Œ I/O å…·æœ‰ä¸ç¡®å®šæ€§
* æ²¡æœ‰å‚è€ƒå®ç°å‘¢ â†’ .red[real research]
</textarea>

<script src="../static/js/remark-latest.min.js"></script>

<script>
  var slideshow = remark.create();
</script>

    <script>
      $(function () {
        $('[data-toggle="tooltip"]').tooltip()
      })

      $("math").each(function() {
        var tex = $(this).text();
        var html = katex.renderToString(tex, {
          displayMode: $(this).attr('class') == 'block-math',
          throwOnError: false
        });
        $(this).replaceWith(html);
      });

      function get_token() {
        var match = document.cookie.match(new RegExp('(^| )token=([^;]+)'));
        if (match) return match[2];
        else return "";
      }

      var token = get_token();
      var hint = "token", box = $("#token-input");

      if (token == "") { box.val(hint); }
      else { box.val(token); }

      function login() {
        var token = box.val()
        document.cookie = 'token=' + token + '; expires=Fri, 31 Dec 9999 23:59:59 GMT;';
        if (token == '') {
          box.val(hint);
        }
      }
    </script>
  </body>
</html>